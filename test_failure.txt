============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-8.4.2, pluggy-1.6.0 -- C:\Users\kevin\Desktop\ElectroAnalyzer\venv_test\Scripts\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\kevin\Desktop\ElectroAnalyzer
configfile: pytest.ini
plugins: anyio-4.11.0, asyncio-0.25.0, cov-6.0.0, mock-3.14.0, xdist-3.6.0
asyncio: mode=Mode.AUTO, asyncio_default_fixture_loop_scope=None
collecting ... collected 1 item

tests/e2e/test_document_analysis_workflow.py::TestDocumentAnalysisWorkflow::test_complete_analysis_workflow ERROR [100%]

=================================== ERRORS ====================================
_ ERROR at setup of TestDocumentAnalysisWorkflow.test_complete_analysis_workflow _
tests\e2e\conftest.py:215: in authenticated_headers
    assert response.status_code in [200, 201, 409]  # 409 if user already exists
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   assert 500 in [200, 201, 409]
E    +  where 500 = <Response [500 Internal Server Error]>.status_code
---------------------------- Captured stdout setup ----------------------------
2025-10-21 13:54:55,396 - src.api.middleware.performance_monitoring - INFO - Performance monitoring middleware initialized
2025-10-21 13:54:55,396 - logging_setup - INFO - {"event": "Structured logging configured successfully.", "logger": "logging_setup", "level": "info", "timestamp": "2025-10-21T20:54:55.396365Z"}
{"event": "Structured logging configured successfully.", "logger": "logging_setup", "level": "info", "timestamp": "2025-10-21T20:54:55.396365Z"}
2025-10-21 13:54:55,396 - src.database.database - INFO - Initializing database schema
Initializing database schema
2025-10-21 13:54:55,403 - src.database.database - INFO - Applying SQLite performance optimizations
Applying SQLite performance optimizations
2025-10-21 13:54:55,410 - src.database.database - INFO - Database initialization complete
Database initialization complete
2025-10-21 13:54:55,410 - src.api.dependencies - INFO - Application starting up...
Application starting up...
2025-10-21 13:54:55,410 - src.api.dependencies - INFO - Initializing real AnalysisService.
Initializing real AnalysisService.
2025-10-21 13:54:55,410 - src.api.dependencies - INFO - Retriever instance not found, creating a new one.
Retriever instance not found, creating a new one.
2025-10-21 13:54:55,410 - sentence_transformers.SentenceTransformer - INFO - Use pytorch device_name: cpu
Use pytorch device_name: cpu
2025-10-21 13:54:55,410 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
2025-10-21 13:54:58,211 - src.core.query_expander - INFO - Initialized default medical vocabulary
Initialized default medical vocabulary
2025-10-21 13:54:58,211 - src.api.dependencies - INFO - New retriever instance created and initialized.
New retriever instance created and initialized.
2025-10-21 13:54:58,211 - src.core.analysis_service - INFO - AnalysisService initialized with use_mocks=False
AnalysisService initialized with use_mocks=False
2025-10-21 13:54:58,211 - presidio-analyzer - INFO - nlp_engine not provided, creating default.
nlp_engine not provided, creating default.
2025-10-21 13:54:59,469 - presidio-analyzer - INFO - Created NLP engine: spacy. Loaded models: ['en']
Created NLP engine: spacy. Loaded models: ['en']
2025-10-21 13:54:59,656 - presidio-analyzer - INFO - Loaded recognizer: CreditCardRecognizer
Loaded recognizer: CreditCardRecognizer
2025-10-21 13:54:59,656 - presidio-analyzer - INFO - Loaded recognizer: CreditCardRecognizer
Loaded recognizer: CreditCardRecognizer
2025-10-21 13:54:59,656 - presidio-analyzer - INFO - Loaded recognizer: CreditCardRecognizer
Loaded recognizer: CreditCardRecognizer
2025-10-21 13:54:59,656 - presidio-analyzer - INFO - Loaded recognizer: CreditCardRecognizer
Loaded recognizer: CreditCardRecognizer
2025-10-21 13:54:59,656 - presidio-analyzer - INFO - Loaded recognizer: UsBankRecognizer
Loaded recognizer: UsBankRecognizer
2025-10-21 13:54:59,656 - presidio-analyzer - INFO - Loaded recognizer: UsLicenseRecognizer
Loaded recognizer: UsLicenseRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: UsItinRecognizer
Loaded recognizer: UsItinRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: UsPassportRecognizer
Loaded recognizer: UsPassportRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: UsSsnRecognizer
Loaded recognizer: UsSsnRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: NhsRecognizer
Loaded recognizer: NhsRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: SgFinRecognizer
Loaded recognizer: SgFinRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: AuAbnRecognizer
Loaded recognizer: AuAbnRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: AuAcnRecognizer
Loaded recognizer: AuAcnRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: AuTfnRecognizer
Loaded recognizer: AuTfnRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: AuMedicareRecognizer
Loaded recognizer: AuMedicareRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: InPanRecognizer
Loaded recognizer: InPanRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: InAadhaarRecognizer
Loaded recognizer: InAadhaarRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: InVehicleRegistrationRecognizer
Loaded recognizer: InVehicleRegistrationRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: InPassportRecognizer
Loaded recognizer: InPassportRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: EsNifRecognizer
Loaded recognizer: EsNifRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: EsNieRecognizer
Loaded recognizer: EsNieRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: ItDriverLicenseRecognizer
Loaded recognizer: ItDriverLicenseRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: ItFiscalCodeRecognizer
Loaded recognizer: ItFiscalCodeRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: ItVatCodeRecognizer
Loaded recognizer: ItVatCodeRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: ItIdentityCardRecognizer
Loaded recognizer: ItIdentityCardRecognizer
2025-10-21 13:54:59,665 - presidio-analyzer - INFO - Loaded recognizer: ItPassportRecognizer
Loaded recognizer: ItPassportRecognizer
2025-10-21 13:54:59,669 - presidio-analyzer - INFO - Loaded recognizer: PlPeselRecognizer
Loaded recognizer: PlPeselRecognizer
2025-10-21 13:54:59,669 - presidio-analyzer - INFO - Loaded recognizer: CryptoRecognizer
Loaded recognizer: CryptoRecognizer
2025-10-21 13:54:59,669 - presidio-analyzer - INFO - Loaded recognizer: DateRecognizer
Loaded recognizer: DateRecognizer
2025-10-21 13:54:59,669 - presidio-analyzer - INFO - Loaded recognizer: EmailRecognizer
Loaded recognizer: EmailRecognizer
2025-10-21 13:54:59,669 - presidio-analyzer - INFO - Loaded recognizer: IbanRecognizer
Loaded recognizer: IbanRecognizer
2025-10-21 13:54:59,671 - presidio-analyzer - INFO - Loaded recognizer: IpRecognizer
Loaded recognizer: IpRecognizer
2025-10-21 13:54:59,671 - presidio-analyzer - INFO - Loaded recognizer: MedicalLicenseRecognizer
Loaded recognizer: MedicalLicenseRecognizer
2025-10-21 13:54:59,671 - presidio-analyzer - INFO - Loaded recognizer: PhoneRecognizer
Loaded recognizer: PhoneRecognizer
2025-10-21 13:54:59,671 - presidio-analyzer - INFO - Loaded recognizer: UrlRecognizer
Loaded recognizer: UrlRecognizer
2025-10-21 13:54:59,671 - presidio-analyzer - INFO - Loaded recognizer: InVoterRecognizer
Loaded recognizer: InVoterRecognizer
2025-10-21 13:54:59,671 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: es, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: es, registry supported languages: en
2025-10-21 13:54:59,671 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: it, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: it, registry supported languages: en
2025-10-21 13:54:59,671 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: pl, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: pl, registry supported languages: en
2025-10-21 13:54:59,671 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - EsNifRecognizer supported languages: es, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - EsNifRecognizer supported languages: es, registry supported languages: en
2025-10-21 13:54:59,671 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - EsNieRecognizer supported languages: es, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - EsNieRecognizer supported languages: es, registry supported languages: en
2025-10-21 13:54:59,673 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - ItDriverLicenseRecognizer supported languages: it, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - ItDriverLicenseRecognizer supported languages: it, registry supported languages: en
2025-10-21 13:54:59,673 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - ItFiscalCodeRecognizer supported languages: it, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - ItFiscalCodeRecognizer supported languages: it, registry supported languages: en
2025-10-21 13:54:59,673 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - ItVatCodeRecognizer supported languages: it, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - ItVatCodeRecognizer supported languages: it, registry supported languages: en
2025-10-21 13:54:59,673 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - ItIdentityCardRecognizer supported languages: it, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - ItIdentityCardRecognizer supported languages: it, registry supported languages: en
2025-10-21 13:54:59,673 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - ItPassportRecognizer supported languages: it, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - ItPassportRecognizer supported languages: it, registry supported languages: en
2025-10-21 13:54:59,673 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - PlPeselRecognizer supported languages: pl, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - PlPeselRecognizer supported languages: pl, registry supported languages: en
2025-10-21 13:54:59,673 - presidio-analyzer - INFO - Loaded recognizer: SpacyRecognizer
Loaded recognizer: SpacyRecognizer
2025-10-21 13:54:59,772 - src.core.preprocessing_service - INFO - Successfully loaded custom medical dictionary from: src/resources/medical_dictionary.txt
Successfully loaded custom medical dictionary from: src/resources/medical_dictionary.txt
2025-10-21 13:54:59,772 - src.core.unified_explanation_engine - INFO - Unified explanation engine initialized with caching=True
Unified explanation engine initialized with caching=True
2025-10-21 13:54:59,772 - src.core.advanced_ensemble_optimizer - INFO - Advanced ensemble optimizer initialized with learning=True
Advanced ensemble optimizer initialized with learning=True
2025-10-21 13:54:59,772 - src.core.human_feedback_system - INFO - Human feedback system initialized with learning=True
Human feedback system initialized with learning=True
2025-10-21 13:54:59,783 - src.core.accuracy_hallucination_tracker - INFO - AccuracyHallucinationTracker initialized with tracking enabled: True
AccuracyHallucinationTracker initialized with tracking enabled: True
2025-10-21 13:54:59,789 - src.core.safe_accuracy_improvements - INFO - SafeAccuracyEnhancer initialized with 10 strategies
SafeAccuracyEnhancer initialized with 10 strategies
2025-10-21 13:54:59,789 - src.core.multi_tier_cache - INFO - Multi-tier cache system initialized: L1=200MB, L2=False, L3=True, Policy=lru
Multi-tier cache system initialized: L1=200MB, L2=False, L3=True, Policy=lru
2025-10-21 13:54:59,796 - src.core.clinical_education_engine - INFO - Clinical education engine initialized with 5 learning objectives and 5 content items
Clinical education engine initialized with 5 learning objectives and 5 content items
2025-10-21 13:54:59,796 - src.core.analysis_service - INFO - 7 Habits Framework initialized successfully
7 Habits Framework initialized successfully
2025-10-21 13:54:59,796 - src.core.rag_database_integration - INFO - RAG database initialized successfully
RAG database initialized successfully
2025-10-21 13:54:59,796 - src.core.analysis_service - INFO - RAG system initialized successfully
RAG system initialized successfully
2025-10-21 13:54:59,796 - src.core.model_selection_utils - INFO - Selected generator profile cpu_tinyllama_clinical (system memory {mem_gb} GB)
Selected generator profile cpu_tinyllama_clinical (system memory {mem_gb} GB)
2025-10-21 13:54:59,796 - src.core.model_selection_utils - WARNING - Configured generator_local_path does not exist: C:\Users\kevin\Desktop\ElectroAnalyzer\models\tinyllama-clinical
Configured generator_local_path does not exist: C:\Users\kevin\Desktop\ElectroAnalyzer\models\tinyllama-clinical
2025-10-21 13:54:59,796 - src.core.ner - INFO - Loading clinical NER model: OpenMed/OpenMed-NER-PathologyDetect-PubMed-v2-109M
Loading clinical NER model: OpenMed/OpenMed-NER-PathologyDetect-PubMed-v2-109M
2025-10-21 13:55:00,464 - src.core.ner - INFO - Successfully loaded clinical NER model: OpenMed/OpenMed-NER-PathologyDetect-PubMed-v2-109M
Successfully loaded clinical NER model: OpenMed/OpenMed-NER-PathologyDetect-PubMed-v2-109M
2025-10-21 13:55:00,464 - src.core.ner - INFO - Loading clinical NER model: d4data/biomedical-ner-all
Loading clinical NER model: d4data/biomedical-ner-all
2025-10-21 13:55:00,906 - src.core.ner - INFO - Successfully loaded clinical NER model: d4data/biomedical-ner-all
Successfully loaded clinical NER model: d4data/biomedical-ner-all
2025-10-21 13:55:00,906 - presidio-analyzer - INFO - nlp_engine not provided, creating default.
nlp_engine not provided, creating default.
2025-10-21 13:55:01,904 - presidio-analyzer - INFO - Created NLP engine: spacy. Loaded models: ['en']
Created NLP engine: spacy. Loaded models: ['en']
2025-10-21 13:55:01,904 - presidio-analyzer - INFO - registry not provided, creating default.
registry not provided, creating default.
2025-10-21 13:55:01,904 - presidio-analyzer - INFO - Loaded recognizer: CreditCardRecognizer
Loaded recognizer: CreditCardRecognizer
2025-10-21 13:55:01,904 - presidio-analyzer - INFO - Loaded recognizer: CreditCardRecognizer
Loaded recognizer: CreditCardRecognizer
2025-10-21 13:55:01,904 - presidio-analyzer - INFO - Loaded recognizer: CreditCardRecognizer
Loaded recognizer: CreditCardRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: CreditCardRecognizer
Loaded recognizer: CreditCardRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: UsBankRecognizer
Loaded recognizer: UsBankRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: UsLicenseRecognizer
Loaded recognizer: UsLicenseRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: UsItinRecognizer
Loaded recognizer: UsItinRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: UsPassportRecognizer
Loaded recognizer: UsPassportRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: UsSsnRecognizer
Loaded recognizer: UsSsnRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: NhsRecognizer
Loaded recognizer: NhsRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: SgFinRecognizer
Loaded recognizer: SgFinRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: AuAbnRecognizer
Loaded recognizer: AuAbnRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: AuAcnRecognizer
Loaded recognizer: AuAcnRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: AuTfnRecognizer
Loaded recognizer: AuTfnRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: AuMedicareRecognizer
Loaded recognizer: AuMedicareRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: InPanRecognizer
Loaded recognizer: InPanRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: InAadhaarRecognizer
Loaded recognizer: InAadhaarRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: InVehicleRegistrationRecognizer
Loaded recognizer: InVehicleRegistrationRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: InPassportRecognizer
Loaded recognizer: InPassportRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: EsNifRecognizer
Loaded recognizer: EsNifRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: EsNieRecognizer
Loaded recognizer: EsNieRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: ItDriverLicenseRecognizer
Loaded recognizer: ItDriverLicenseRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: ItFiscalCodeRecognizer
Loaded recognizer: ItFiscalCodeRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: ItVatCodeRecognizer
Loaded recognizer: ItVatCodeRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: ItIdentityCardRecognizer
Loaded recognizer: ItIdentityCardRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: ItPassportRecognizer
Loaded recognizer: ItPassportRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: PlPeselRecognizer
Loaded recognizer: PlPeselRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: CryptoRecognizer
Loaded recognizer: CryptoRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: DateRecognizer
Loaded recognizer: DateRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: EmailRecognizer
Loaded recognizer: EmailRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: IbanRecognizer
Loaded recognizer: IbanRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: IpRecognizer
Loaded recognizer: IpRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: MedicalLicenseRecognizer
Loaded recognizer: MedicalLicenseRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: PhoneRecognizer
Loaded recognizer: PhoneRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: UrlRecognizer
Loaded recognizer: UrlRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: InVoterRecognizer
Loaded recognizer: InVoterRecognizer
2025-10-21 13:55:01,912 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: es, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: es, registry supported languages: en
2025-10-21 13:55:01,912 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: it, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: it, registry supported languages: en
2025-10-21 13:55:01,912 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: pl, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: pl, registry supported languages: en
2025-10-21 13:55:01,912 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - EsNifRecognizer supported languages: es, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - EsNifRecognizer supported languages: es, registry supported languages: en
2025-10-21 13:55:01,912 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - EsNieRecognizer supported languages: es, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - EsNieRecognizer supported languages: es, registry supported languages: en
2025-10-21 13:55:01,912 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - ItDriverLicenseRecognizer supported languages: it, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - ItDriverLicenseRecognizer supported languages: it, registry supported languages: en
2025-10-21 13:55:01,912 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - ItFiscalCodeRecognizer supported languages: it, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - ItFiscalCodeRecognizer supported languages: it, registry supported languages: en
2025-10-21 13:55:01,912 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - ItVatCodeRecognizer supported languages: it, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - ItVatCodeRecognizer supported languages: it, registry supported languages: en
2025-10-21 13:55:01,912 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - ItIdentityCardRecognizer supported languages: it, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - ItIdentityCardRecognizer supported languages: it, registry supported languages: en
2025-10-21 13:55:01,912 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - ItPassportRecognizer supported languages: it, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - ItPassportRecognizer supported languages: it, registry supported languages: en
2025-10-21 13:55:01,912 - presidio-analyzer - WARNING - Recognizer not added to registry because language is not supported by registry - PlPeselRecognizer supported languages: pl, registry supported languages: en
Recognizer not added to registry because language is not supported by registry - PlPeselRecognizer supported languages: pl, registry supported languages: en
2025-10-21 13:55:01,912 - presidio-analyzer - INFO - Loaded recognizer: SpacyRecognizer
Loaded recognizer: SpacyRecognizer
2025-10-21 13:55:01,928 - src.core.unified_explanation_engine - INFO - Unified explanation engine initialized with caching=True
Unified explanation engine initialized with caching=True
2025-10-21 13:55:01,930 - src.core.compliance_analyzer - INFO - Loaded existing confidence calibrator
Loaded existing confidence calibrator
2025-10-21 13:55:01,930 - src.core.compliance_analyzer - INFO - ComplianceAnalyzer initialized with all services.
ComplianceAnalyzer initialized with all services.
2025-10-21 13:55:01,933 - src.api.dependencies - INFO - Application startup complete. Services are initialized.
Application startup complete. Services are initialized.
2025-10-21 13:55:01,933 - src.api.main - INFO - {"event": "Vector store initialization started in background", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.933320Z"}
{"event": "Vector store initialization started in background", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.933320Z"}
2025-10-21 13:55:01,933 - apscheduler.scheduler - INFO - Adding job tentatively -- it will be properly scheduled when the scheduler starts
Adding job tentatively -- it will be properly scheduled when the scheduler starts
2025-10-21 13:55:01,933 - apscheduler.scheduler - INFO - Added job "run_maintenance_jobs" to job store "default"
Added job "run_maintenance_jobs" to job store "default"
2025-10-21 13:55:01,933 - apscheduler.scheduler - INFO - Scheduler started
Scheduler started
2025-10-21 13:55:01,936 - src.api.main - INFO - {"event": "Scheduler started for daily maintenance tasks.", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.933320Z"}
{"event": "Scheduler started for daily maintenance tasks.", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.933320Z"}
2025-10-21 13:55:01,937 - src.api.main - INFO - {"event": "Starting in-memory task purge service.", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.937113Z"}
{"event": "Starting in-memory task purge service.", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.937113Z"}
2025-10-21 13:55:01,937 - src.api.main - INFO - {"event": "Cleanup services started in background", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.937113Z"}
{"event": "Cleanup services started in background", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.937113Z"}
2025-10-21 13:55:01,937 - src.api.main - INFO - {"event": "Request tracking initialized", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.937113Z"}
{"event": "Request tracking initialized", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.937113Z"}
2025-10-21 13:55:01,939 - src.api.main - INFO - {"event": "Error handling initialized", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
{"event": "Error handling initialized", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
2025-10-21 13:55:01,939 - src.api.main - INFO - {"event": "Enhanced worker manager and task registry cleanup started in background", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
{"event": "Enhanced worker manager and task registry cleanup started in background", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
2025-10-21 13:55:01,939 - src.core.service_manager - INFO - {"service": "api", "port": 8001, "event": "Registered service", "logger": "src.core.service_manager", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
{"service": "api", "port": 8001, "event": "Registered service", "logger": "src.core.service_manager", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
2025-10-21 13:55:01,939 - src.core.service_manager - INFO - {"service": "frontend", "port": 3001, "event": "Registered service", "logger": "src.core.service_manager", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
{"service": "frontend", "port": 3001, "event": "Registered service", "logger": "src.core.service_manager", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
2025-10-21 13:55:01,939 - src.api.main - INFO - {"event": "Service manager initialized", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
{"event": "Service manager initialized", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
2025-10-21 13:55:01,939 - src.core.vector_store - INFO - FAISS index initialized with embedding dimension: 768
FAISS index initialized with embedding dimension: 768
2025-10-21 13:55:01,939 - src.api.main - INFO - {"event": "Populating vector store with existing report embeddings...", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
{"event": "Populating vector store with existing report embeddings...", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
2025-10-21 13:55:02,041 - src.core.performance_metrics_collector - WARNING - High memory usage detected: 2203.78MB
High memory usage detected: 2203.78MB
2025-10-21 13:55:02,041 - src.core.file_cleanup_service - INFO - Starting file cleanup service...
Starting file cleanup service...
2025-10-21 13:55:02,041 - src.core.document_cleanup_service - INFO - Document cleanup service started (interval: 1h, max_age: 24h)
Document cleanup service started (interval: 1h, max_age: 24h)
2025-10-21 13:55:02,041 - src.core.cleanup_services - INFO - Registered cleanup service: document
Registered cleanup service: document
2025-10-21 13:55:02,041 - src.core.cleanup_services - INFO - Registered cleanup service: session
Registered cleanup service: session
2025-10-21 13:55:02,041 - src.core.cleanup_services - INFO - Registered cleanup service: log
Registered cleanup service: log
2025-10-21 13:55:02,041 - src.core.cleanup_services - INFO - Registered cleanup service: database
Registered cleanup service: database
2025-10-21 13:55:02,041 - src.core.cleanup_services - INFO - Registered cleanup service: system
Registered cleanup service: system
2025-10-21 13:55:02,041 - src.core.cleanup_services - INFO - document cleanup service started
document cleanup service started
2025-10-21 13:55:02,041 - src.core.cleanup_services - INFO - session cleanup service started
session cleanup service started
2025-10-21 13:55:02,041 - src.core.cleanup_services - INFO - log cleanup service started
log cleanup service started
2025-10-21 13:55:02,041 - src.core.cleanup_services - INFO - database cleanup service started
database cleanup service started
2025-10-21 13:55:02,041 - src.core.cleanup_services - INFO - system cleanup service started
system cleanup service started
2025-10-21 13:55:02,041 - src.core.cleanup_services - INFO - All cleanup services started
All cleanup services started
2025-10-21 13:55:02,041 - src.core.enhanced_worker_manager - INFO - {"event": "Worker manager started", "logger": "src.core.enhanced_worker_manager", "level": "info", "timestamp": "2025-10-21T20:55:02.041516Z"}
{"event": "Worker manager started", "logger": "src.core.enhanced_worker_manager", "level": "info", "timestamp": "2025-10-21T20:55:02.041516Z"}
2025-10-21 13:55:02,053 - src.core.document_cleanup_service - INFO - Starting document cleanup
Starting document cleanup
2025-10-21 13:55:02,053 - src.core.cleanup_services - INFO - Starting document cleanup
Starting document cleanup
2025-10-21 13:55:02,053 - src.core.cleanup_services - INFO - Starting session cleanup
Starting session cleanup
2025-10-21 13:55:02,053 - src.core.cleanup_services - INFO - Starting log cleanup
Starting log cleanup
2025-10-21 13:55:02,057 - src.core.cleanup_services - INFO - Log cleanup completed: 0 files cleaned
Log cleanup completed: 0 files cleaned
2025-10-21 13:55:02,057 - src.core.cleanup_services - INFO - Starting database cleanup
Starting database cleanup
2025-10-21 13:55:02,057 - src.core.cleanup_services - INFO - Database cleanup completed
Database cleanup completed
2025-10-21 13:55:02,057 - src.core.cleanup_services - INFO - Starting system resource cleanup
Starting system resource cleanup
2025-10-21 13:55:02,124 - src.core.cleanup_services - INFO - System resource cleanup completed: 0 items cleaned
System resource cleanup completed: 0 items cleaned
2025-10-21 13:55:02,126 - src.core.enhanced_worker_manager - INFO - {"event": "Worker loop started", "logger": "src.core.enhanced_worker_manager", "level": "info", "timestamp": "2025-10-21T20:55:02.126288Z"}
{"event": "Worker loop started", "logger": "src.core.enhanced_worker_manager", "level": "info", "timestamp": "2025-10-21T20:55:02.126288Z"}
2025-10-21 13:55:02,127 - src.core.document_cleanup_service - INFO - Expired documents cleaned up
Expired documents cleaned up
2025-10-21 13:55:02,131 - src.core.document_cleanup_service - INFO - Cleanup completed: 0 expired docs, 0 temp files, 0 log files
Cleanup completed: 0 expired docs, 0 temp files, 0 log files
2025-10-21 13:55:02,132 - src.core.cleanup_services - INFO - Document cleanup completed: 0 files cleaned
Document cleanup completed: 0 files cleaned
2025-10-21 13:55:02,132 - src.core.cleanup_services - INFO - Session cleanup completed: 0 sessions cleaned
Session cleanup completed: 0 sessions cleaned
2025-10-21 13:55:02,133 - src.api.middleware.request_tracking - INFO - Request started: POST /auth/register
Request started: POST /auth/register
2025-10-21 13:55:02,137 - requests - INFO - Request: POST /auth/register
Request: POST /auth/register
2025-10-21 13:55:02,138 - src.api.middleware.request_logging - INFO - Request started | id=4b9105e2-f786-43fe-adf1-c7bc591ac4ed | method=POST | url=/auth/register | client_ip=testclient | user_agent=testclient
Request started | id=4b9105e2-f786-43fe-adf1-c7bc591ac4ed | method=POST | url=/auth/register | client_ip=testclient | user_agent=testclient
2025-10-21 13:55:02,142 - src.api.main - INFO - {"event": "No existing reports with embeddings found to populate vector store.", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:02.142522Z"}
{"event": "No existing reports with embeddings found to populate vector store.", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:02.142522Z"}
2025-10-21 13:55:02,361 - src.database.crud - INFO - Created user: test_therapist
Created user: test_therapist
2025-10-21 13:55:02,361 - src.core.advanced_security_system - WARNING - Security event: security_error - Security middleware error: Logger._log() got an unexpected keyword argument 'user_id' (Severity: high)
Security event: security_error - Security middleware error: Logger._log() got an unexpected keyword argument 'user_id' (Severity: high)
2025-10-21 13:55:02,361 - requests - INFO - Response: POST /auth/register -> 500
Response: POST /auth/register -> 500
2025-10-21 13:55:02,361 - src.api.middleware.request_tracking - INFO - Request completed: POST /auth/register - 500
Request completed: POST /auth/register - 500
---------------------------- Captured stderr setup ----------------------------
Device set to use cpu
Device set to use cpu
----------------------------- Captured log setup ------------------------------
INFO     src.api.middleware.performance_monitoring:performance_monitoring.py:39 Performance monitoring middleware initialized
INFO     logging_setup:logging_config.py:83 {"event": "Structured logging configured successfully.", "logger": "logging_setup", "level": "info", "timestamp": "2025-10-21T20:54:55.396365Z"}
INFO     src.database.database:database.py:162 Initializing database schema
INFO     src.database.database:database.py:180 Applying SQLite performance optimizations
INFO     src.database.database:database.py:201 Database initialization complete
INFO     src.api.dependencies:dependencies.py:58 Application starting up...
INFO     src.api.dependencies:dependencies.py:74 Initializing real AnalysisService.
INFO     src.api.dependencies:dependencies.py:47 Retriever instance not found, creating a new one.
INFO     sentence_transformers.SentenceTransformer:SentenceTransformer.py:219 Use pytorch device_name: cpu
INFO     sentence_transformers.SentenceTransformer:SentenceTransformer.py:227 Load pretrained SentenceTransformer: pritamdeka/S-PubMedBert-MS-MARCO
INFO     src.core.query_expander:query_expander.py:213 Initialized default medical vocabulary
INFO     src.api.dependencies:dependencies.py:52 New retriever instance created and initialized.
INFO     src.core.analysis_service:analysis_service.py:134 AnalysisService initialized with use_mocks=False
INFO     presidio-analyzer:analyzer_engine.py:62 nlp_engine not provided, creating default.
INFO     presidio-analyzer:nlp_engine_provider.py:101 Created NLP engine: spacy. Loaded models: ['en']
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: CreditCardRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: CreditCardRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: CreditCardRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: CreditCardRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: UsBankRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: UsLicenseRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: UsItinRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: UsPassportRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: UsSsnRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: NhsRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: SgFinRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: AuAbnRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: AuAcnRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: AuTfnRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: AuMedicareRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: InPanRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: InAadhaarRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: InVehicleRegistrationRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: InPassportRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: EsNifRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: EsNieRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: ItDriverLicenseRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: ItFiscalCodeRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: ItVatCodeRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: ItIdentityCardRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: ItPassportRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: PlPeselRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: CryptoRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: DateRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: EmailRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: IbanRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: IpRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: MedicalLicenseRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: PhoneRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: UrlRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: InVoterRecognizer
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: es, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: it, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: pl, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - EsNifRecognizer supported languages: es, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - EsNieRecognizer supported languages: es, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - ItDriverLicenseRecognizer supported languages: it, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - ItFiscalCodeRecognizer supported languages: it, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - ItVatCodeRecognizer supported languages: it, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - ItIdentityCardRecognizer supported languages: it, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - ItPassportRecognizer supported languages: it, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - PlPeselRecognizer supported languages: pl, registry supported languages: en
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: SpacyRecognizer
INFO     src.core.preprocessing_service:preprocessing_service.py:35 Successfully loaded custom medical dictionary from: src/resources/medical_dictionary.txt
INFO     src.core.unified_explanation_engine:unified_explanation_engine.py:214 Unified explanation engine initialized with caching=True
INFO     src.core.advanced_ensemble_optimizer:advanced_ensemble_optimizer.py:140 Advanced ensemble optimizer initialized with learning=True
INFO     src.core.human_feedback_system:human_feedback_system.py:143 Human feedback system initialized with learning=True
INFO     src.core.accuracy_hallucination_tracker:accuracy_hallucination_tracker.py:141 AccuracyHallucinationTracker initialized with tracking enabled: True
INFO     src.core.safe_accuracy_improvements:safe_accuracy_improvements.py:72 SafeAccuracyEnhancer initialized with 10 strategies
INFO     src.core.multi_tier_cache:multi_tier_cache.py:149 Multi-tier cache system initialized: L1=200MB, L2=False, L3=True, Policy=lru
INFO     src.core.clinical_education_engine:clinical_education_engine.py:169 Clinical education engine initialized with 5 learning objectives and 5 content items
INFO     src.core.analysis_service:analysis_service.py:178 7 Habits Framework initialized successfully
INFO     src.core.rag_database_integration:rag_database_integration.py:116 RAG database initialized successfully
INFO     src.core.analysis_service:analysis_service.py:193 RAG system initialized successfully
INFO     src.core.model_selection_utils:model_selection_utils.py:44 Selected generator profile cpu_tinyllama_clinical (system memory {mem_gb} GB)
WARNING  src.core.model_selection_utils:model_selection_utils.py:69 Configured generator_local_path does not exist: C:\Users\kevin\Desktop\ElectroAnalyzer\models\tinyllama-clinical
INFO     src.core.ner:ner.py:81 Loading clinical NER model: OpenMed/OpenMed-NER-PathologyDetect-PubMed-v2-109M
INFO     src.core.ner:ner.py:92 Successfully loaded clinical NER model: OpenMed/OpenMed-NER-PathologyDetect-PubMed-v2-109M
INFO     src.core.ner:ner.py:81 Loading clinical NER model: d4data/biomedical-ner-all
INFO     src.core.ner:ner.py:92 Successfully loaded clinical NER model: d4data/biomedical-ner-all
INFO     presidio-analyzer:analyzer_engine.py:62 nlp_engine not provided, creating default.
INFO     presidio-analyzer:nlp_engine_provider.py:101 Created NLP engine: spacy. Loaded models: ['en']
INFO     presidio-analyzer:analyzer_engine.py:77 registry not provided, creating default.
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: CreditCardRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: CreditCardRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: CreditCardRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: CreditCardRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: UsBankRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: UsLicenseRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: UsItinRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: UsPassportRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: UsSsnRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: NhsRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: SgFinRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: AuAbnRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: AuAcnRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: AuTfnRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: AuMedicareRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: InPanRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: InAadhaarRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: InVehicleRegistrationRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: InPassportRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: EsNifRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: EsNieRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: ItDriverLicenseRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: ItFiscalCodeRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: ItVatCodeRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: ItIdentityCardRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: ItPassportRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: PlPeselRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: CryptoRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: DateRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: EmailRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: IbanRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: IpRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: MedicalLicenseRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: PhoneRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: UrlRecognizer
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: InVoterRecognizer
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: es, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: it, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - CreditCardRecognizer supported languages: pl, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - EsNifRecognizer supported languages: es, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - EsNieRecognizer supported languages: es, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - ItDriverLicenseRecognizer supported languages: it, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - ItFiscalCodeRecognizer supported languages: it, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - ItVatCodeRecognizer supported languages: it, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - ItIdentityCardRecognizer supported languages: it, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - ItPassportRecognizer supported languages: it, registry supported languages: en
WARNING  presidio-analyzer:recognizers_loader_utils.py:119 Recognizer not added to registry because language is not supported by registry - PlPeselRecognizer supported languages: pl, registry supported languages: en
INFO     presidio-analyzer:entity_recognizer.py:58 Loaded recognizer: SpacyRecognizer
INFO     src.core.unified_explanation_engine:unified_explanation_engine.py:214 Unified explanation engine initialized with caching=True
INFO     src.core.compliance_analyzer:compliance_analyzer.py:119 Loaded existing confidence calibrator
INFO     src.core.compliance_analyzer:compliance_analyzer.py:103 ComplianceAnalyzer initialized with all services.
INFO     src.api.dependencies:dependencies.py:80 Application startup complete. Services are initialized.
INFO     src.api.main:main.py:339 {"event": "Vector store initialization started in background", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.933320Z"}
INFO     apscheduler.scheduler:base.py:507 Adding job tentatively -- it will be properly scheduled when the scheduler starts
INFO     apscheduler.scheduler:base.py:1090 Added job "run_maintenance_jobs" to job store "default"
INFO     apscheduler.scheduler:base.py:214 Scheduler started
INFO     src.api.main:main.py:349 {"event": "Scheduler started for daily maintenance tasks.", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.933320Z"}
INFO     src.api.main:main.py:168 {"event": "Starting in-memory task purge service.", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.937113Z"}
INFO     src.api.main:main.py:359 {"event": "Cleanup services started in background", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.937113Z"}
INFO     src.api.main:main.py:363 {"event": "Request tracking initialized", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.937113Z"}
INFO     src.api.main:main.py:367 {"event": "Error handling initialized", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
INFO     src.api.main:main.py:373 {"event": "Enhanced worker manager and task registry cleanup started in background", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
INFO     src.core.service_manager:service_manager.py:192 {"service": "api", "port": 8001, "event": "Registered service", "logger": "src.core.service_manager", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
INFO     src.core.service_manager:service_manager.py:192 {"service": "frontend", "port": 3001, "event": "Registered service", "logger": "src.core.service_manager", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
INFO     src.api.main:main.py:377 {"event": "Service manager initialized", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
INFO     src.core.vector_store:vector_store.py:68 FAISS index initialized with embedding dimension: 768
INFO     src.api.main:main.py:220 {"event": "Populating vector store with existing report embeddings...", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:01.939182Z"}
WARNING  src.core.performance_metrics_collector:performance_metrics_collector.py:174 High memory usage detected: 2203.78MB
INFO     src.core.file_cleanup_service:file_cleanup_service.py:40 Starting file cleanup service...
INFO     src.core.document_cleanup_service:document_cleanup_service.py:45 Document cleanup service started (interval: 1h, max_age: 24h)
INFO     src.core.cleanup_services:cleanup_services.py:335 Registered cleanup service: document
INFO     src.core.cleanup_services:cleanup_services.py:335 Registered cleanup service: session
INFO     src.core.cleanup_services:cleanup_services.py:335 Registered cleanup service: log
INFO     src.core.cleanup_services:cleanup_services.py:335 Registered cleanup service: database
INFO     src.core.cleanup_services:cleanup_services.py:335 Registered cleanup service: system
INFO     src.core.cleanup_services:cleanup_services.py:46 document cleanup service started
INFO     src.core.cleanup_services:cleanup_services.py:46 session cleanup service started
INFO     src.core.cleanup_services:cleanup_services.py:46 log cleanup service started
INFO     src.core.cleanup_services:cleanup_services.py:46 database cleanup service started
INFO     src.core.cleanup_services:cleanup_services.py:46 system cleanup service started
INFO     src.core.cleanup_services:cleanup_services.py:351 All cleanup services started
INFO     src.core.enhanced_worker_manager:enhanced_worker_manager.py:68 {"event": "Worker manager started", "logger": "src.core.enhanced_worker_manager", "level": "info", "timestamp": "2025-10-21T20:55:02.041516Z"}
INFO     src.core.document_cleanup_service:document_cleanup_service.py:80 Starting document cleanup
INFO     src.core.cleanup_services:cleanup_services.py:101 Starting document cleanup
INFO     src.core.cleanup_services:cleanup_services.py:161 Starting session cleanup
INFO     src.core.cleanup_services:cleanup_services.py:197 Starting log cleanup
INFO     src.core.cleanup_services:cleanup_services.py:215 Log cleanup completed: 0 files cleaned
INFO     src.core.cleanup_services:cleanup_services.py:251 Starting database cleanup
INFO     src.core.cleanup_services:cleanup_services.py:256 Database cleanup completed
INFO     src.core.cleanup_services:cleanup_services.py:272 Starting system resource cleanup
INFO     src.core.cleanup_services:cleanup_services.py:292 System resource cleanup completed: 0 items cleaned
INFO     src.core.enhanced_worker_manager:enhanced_worker_manager.py:249 {"event": "Worker loop started", "logger": "src.core.enhanced_worker_manager", "level": "info", "timestamp": "2025-10-21T20:55:02.126288Z"}
INFO     src.core.document_cleanup_service:document_cleanup_service.py:110 Expired documents cleaned up
INFO     src.core.document_cleanup_service:document_cleanup_service.py:91 Cleanup completed: 0 expired docs, 0 temp files, 0 log files
INFO     src.core.cleanup_services:cleanup_services.py:126 Document cleanup completed: 0 files cleaned
INFO     src.core.cleanup_services:cleanup_services.py:178 Session cleanup completed: 0 sessions cleaned
INFO     src.api.middleware.request_tracking:request_tracking.py:49 Request started: POST /auth/register
INFO     requests:enhanced_logging.py:85 Request: POST /auth/register
INFO     src.api.middleware.request_logging:request_logging.py:64 Request started | id=4b9105e2-f786-43fe-adf1-c7bc591ac4ed | method=POST | url=/auth/register | client_ip=testclient | user_agent=testclient
INFO     src.api.main:main.py:251 {"event": "No existing reports with embeddings found to populate vector store.", "logger": "src.api.main", "level": "info", "timestamp": "2025-10-21T20:55:02.142522Z"}
INFO     src.database.crud:crud.py:98 Created user: test_therapist
WARNING  src.core.advanced_security_system:advanced_security_system.py:258 Security event: security_error - Security middleware error: Logger._log() got an unexpected keyword argument 'user_id' (Severity: high)
INFO     requests:enhanced_logging.py:107 Response: POST /auth/register -> 500
INFO     src.api.middleware.request_tracking:request_tracking.py:68 Request completed: POST /auth/register - 500
=========================== short test summary info ===========================
ERROR tests/e2e/test_document_analysis_workflow.py::TestDocumentAnalysisWorkflow::test_complete_analysis_workflow
============================== 1 error in 7.46s ===============================
