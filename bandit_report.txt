Run started:2025-09-23 21:00:49.564349

Test results:
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b403-import-pickle
   Location: src/core/build_bm25_index.py:2:0
1	import re
2	import pickle
3	from rank_bm25 import BM25Okapi

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: src/core/compliance_analyzer.py:25:35
24
25	        self.generator_tokenizer = AutoTokenizer.from_pretrained(generator_model_name)
26	        self.generator_model = AutoModelForCausalLM.from_pretrained(

--------------------------------------------------
>> Issue: [B615:huggingface_unsafe_download] Unsafe Hugging Face Hub download without revision pinning in from_pretrained()
   Severity: Medium   Confidence: High
   CWE: CWE-494 (https://cwe.mitre.org/data/definitions/494.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/plugins/b615_huggingface_unsafe_download.html
   Location: src/core/compliance_analyzer.py:26:31
25	        self.generator_tokenizer = AutoTokenizer.from_pretrained(generator_model_name)
26	        self.generator_model = AutoModelForCausalLM.from_pretrained(
27	            generator_model_name,
28	            load_in_4bit=True,
29	            torch_dtype=torch.bfloat16, # Use bfloat16 for better performance on modern GPUs
30	            device_map="auto"
31	        )
32	        logging.info(f"Generator LLM '{generator_model_name}' loaded successfully.")

--------------------------------------------------
>> Issue: [B403:blacklist] Consider possible security implications associated with pickle module.
   Severity: Low   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_imports.html#b403-import-pickle
   Location: src/core/hybrid_retriever.py:1:0
1	import pickle
2	import logging
3	import os

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: src/core/hybrid_retriever.py:18:24
17	        with open(os.path.join("data", "bm25_index.pkl"), "rb") as f:
18	            self.bm25 = pickle.load(f)
19	        with open(os.path.join("data", "medicare_guideline_corpus.pkl"), "rb") as f:

--------------------------------------------------
>> Issue: [B301:blacklist] Pickle and modules that wrap it can be unsafe when used to deserialize untrusted data, possible security issue.
   Severity: Medium   Confidence: High
   CWE: CWE-502 (https://cwe.mitre.org/data/definitions/502.html)
   More Info: https://bandit.readthedocs.io/en/1.8.6/blacklists/blacklist_calls.html#b301-pickle
   Location: src/core/hybrid_retriever.py:20:26
19	        with open(os.path.join("data", "medicare_guideline_corpus.pkl"), "rb") as f:
20	            self.corpus = pickle.load(f)
21

--------------------------------------------------

Code scanned:
	Total lines of code: 1086
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 2
		Medium: 4
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 0
		High: 6
Files skipped (0):
